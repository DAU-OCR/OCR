# 🧠 ResNet34 OCR 학습 트러블슈팅 기록

## ✅ 실험 환경

- **Backbone**: ResNet34  
- **Data Augmentation**: `aug_prob: 0.5`  
- **Pretrained Model**: 사용 (`rec_r34_vd_none_bilstm_ctc`)  
- **Optimizer**: AdamW + LinearWarmupCosine  
- **환경**: GPU 학습, CPU(i5-8400) 추론 고려

---

## 📊 학습 결과 요약

- Pretrained model을 사용하자, **초기 수렴 속도는 향상됨**
- 하지만 전체적인 인식률은 ResNet18과 거의 동일 (약 **eval/acc 0.8**)
- `eval/acc`가 **30 epoch 전까지 매우 불안정하고 튀는 현상** 지속
- 정체 원인을 찾기 위해 **데이터 및 예측 결과 수동 확인** 진행

---

## 🧩 문제 분석: 구형 초록 번호판 (지명 포함)

### 🚨 현상

- `eval/acc`가 **갑자기 0으로 떨어지는** 상황 발생
- 예측 실패 이미지 확인 결과:
  - **초록색 배경의 구형 번호판**
  - `"경기"`는 인식되지만 `"부산"`, `"경남"` 등은 예측 실패

### 🔍 원인

- 학습 데이터에서 **지명 포함 번호판이 특정 지역(`"경기"`)에 치우쳐 있음**
- `"부산"`, `"경남"` 등의 지역은 거의 등장하지 않아 **모델이 학습 불가능**
- validation에 이런 번호판이 등장할 경우 → 성능 급락

---

## 🤝 팀 논의 및 결정

- **실제 환경(2025년 기준)**에서는 지명이 포함된 초록 번호판의 사용률이 매우 낮음
- 따라서 학습 데이터에서 **지명 포함 초록 번호판은 제거하기로 결정**

> ✅ **학습 대상에서 지명 포함 초록 번호판 제거**

---

## 🚀 기대 효과

- 불균형 및 오류 유발 데이터 제거 → `eval/acc` **안정화 기대**
- 모델이 **실제 사용률 높은 번호판 패턴에 집중**할 수 있음
- **정확도 95% 이상 도달** 가능성 있음

---

## 🔄 추가 전략: 2줄 번호판 처리 및 파인튜닝

구형, 이례적 번호판 (예: **2줄, 한글 시작**)은 따로 처리할 계획

### 💡 아이디어

1. **OpenCV 기반 처리**
   - 이미지의 비트 밀도를 기준으로 **줄 바꿈 구간** 탐지
   - 윗 줄을 잘라 **아랫 줄 왼쪽에 붙이는 방식**으로 병합

2. **YOLO 기반 처리**
   - YOLO로 **글자 영역만 탐지**
   - 줄 단위로 탐지한 후 **줄을 하나로 병합하여 단일 라인 생성**

> ⛔ 아직 구현 전, 성능은 미지수이나 **시도할 가치 있음**

---

## 🔚 요약

- Pretrained 모델은 **수렴 속도는 빠르지만 성능은 동일**
- 데이터 편향이 성능 저하의 큰 원인 중 하나였음
- 지명 포함 번호판 제거 및 구조 개선을 통해 **정확도 향상 기대**
- 향후 2줄 번호판 대응 및 파인튜닝으로 **실사용 완성도 확보 예정**